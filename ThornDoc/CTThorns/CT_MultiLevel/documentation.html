<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>CT_MultiLevel</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- mathjax,charset=utf-8,html,xhtml --> 
<meta name="src" content="documentation.tex" /> 
<link rel="stylesheet" type="text/css" href="documentation.css" /> 
 <script type="text/x-mathjax-config"> MathJax.Hub.Config({ 'fast-preview': {disabled: true}, TeX: { extensions: ["color.js","AMSmath.js"], equationNumbers: { autoNumber: "AMS" } }, extensions: ["tex2jax.js"], tex2jax: {  inlineMath: [ ["\\\(","\\\)"] ], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], processEscapes: true, processEnvironments: true } }); </script> 
 <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>  
</head><body 
>
<div class="maketitle">
                                                                                       
                                                                                       
                                                                                       
                                                                                       

<h2 class="titleHead">CT_MultiLevel</h2>
<div class="author" ><span 
class="cmr-12">Eloisa Bentivegna </span><span 
class="cmmi-12">&#x003C;</span><span 
class="cmr-12">eloisa.bentivegna@ct.infn.it</span><span 
class="cmmi-12">&#x003E;</span></div>
<br />
<div class="date" ><span 
class="cmr-12">May 27 2013</span></div>
</div>
<div 
class="abstract" 
>
<div class="center" 
>
<!--l. 104--><p class="noindent" >
</p><!--l. 104--><p class="noindent" ><span 
class="cmbx-9">Abstract</span></p></div>
     <!--l. 105--><p class="indent" >    <span 
class="cmr-9">This thorn implements a multigrid solver for systems of elliptic partial differential equations. It</span>
     <span 
class="cmr-9">uses </span><span 
class="cmtt-9">Carpet</span><span 
class="cmr-9">’s interface to handle loops over the grid hierarchy and pass information between different</span>
     <span 
class="cmr-9">components. The system of equations is passed to the solver via parameters pointing to the external</span>
     <span 
class="cmr-9">grid functions that hold the equation coefficients.</span>
</p>
</div>
<h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Introduction</h3>
<!--l. 117--><p class="noindent" ><span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel </span>is a Cactus thorn that implements a multigrid solver for elliptic partial differential equations
(PDEs). The implementation is rather standard, and it also allows for local AMR grids (in which case it uses a
rudimentary <span 
class="cmti-10">multilevel </span>algorithm).
</p><!--l. 122--><p class="noindent" >This thorn requires <span 
class="cmtt-10">Carpet</span>, which it uses to manage the access to the grid structure (via the <span 
class="cmtt-10">BEGIN</span><span 
class="cmtt-10">_*</span><span 
class="cmtt-10">_LOOP </span>and
<span 
class="cmtt-10">END</span><span 
class="cmtt-10">_*</span><span 
class="cmtt-10">_LOOP </span>macros) and to pass information between the different levels (via the restriction and prolongation
operators).
                                                                                       
                                                                                       
</p><!--l. 127--><p class="noindent" >Structurally, the solver can tackle any type of equation or system of equations, their coefficients
being passed to <span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel </span>via string parameters holding the names of the corresponding grid
function. The thorn comes with a number of test cases which should be easy to customize and
extend.
</p><!--l. 133--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>Principle of multigrid</h3>
<!--l. 134--><p class="noindent" >Multigrid schemes are designed to solve elliptic equations on a hierarchy of grids, with the goal of speeding up
the convergence rate of relaxation algorithms (such as Gauss-Seidel) by eliminating different frequency modes of
the solution error on different grids. It is known that relaxation techniques are very effective at eliminating the
high-frequency part of the error; when solving an elliptic PDE on a grid, it is then advantageous to relax it on a
coarser grid beforehand and interpolate the result back onto the original grid. Complex schemes involving several
grid levels, each with a different PDE, can be designed to maximize the speed up. Please refer to <span class="cite">[<span 
class="cmbx-10">?</span>]</span> for the
details.
</p><!--l. 146--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-30003"></a>Using This Thorn</h3>
<!--l. 147--><p class="noindent" ><span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel</span>, along with the rest of the <span 
class="cmtt-10">Cosmology </span>arrangement, is released under the General Public
License, version 2 and higher. The copyright of this thorn remains with myself.
</p><!--l. 151--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-40003.1"></a>Obtaining This Thorn</h4>
<!--l. 152--><p class="noindent" ><span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel </span>is publicly available in COSMOTOOLKIT’s git repository:
                                                                                       
                                                                                       
</p>
<div class="verbatim" id="verbatim-1">
   git clone https://eloisa@bitbucket.org/eloisa/cosmology.git
</div>
<!--l. 156--><p class="nopar" > A helper thorn <span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_Analytic </span>is available under the same repository.
</p><!--l. 159--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-50003.2"></a>Basic Usage</h4>
<!--l. 160--><p class="noindent" >In order to solve an elliptic PDE with <span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel</span>, <span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel </span>can be simply compiled in, with the
requirement that <span 
class="cmtt-10">Carpet </span>is compiled as well. The thorn also inherits from <span 
class="cmtt-10">boundary </span>and <span 
class="cmtt-10">grid </span>for boundary
APIs and coordinate labels.
</p><!--l. 166--><p class="noindent" >Currently, the equation is solved in a single schedule call at <span 
class="cmtt-10">CCTK</span><span 
class="cmtt-10">_INITIAL</span>, in <span 
class="cmtt-10">GLOBAL</span><span 
class="cmtt-10">_LATE </span>mode (to ensure
that necessary objects such as the grid arrays have been populated).
</p><!--l. 170--><p class="noindent" >As the equation coefficients will be set by grid functions, a thorn allocating and setting these grid functions to
the desired values has to be included. Another thorn in the <span 
class="cmtt-10">Cosmology </span>arrangement, <span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_Analytic</span>, serves this
purpose. Grid functions of other origin are naturally just as good.
</p><!--l. 176--><p class="noindent" >Each equation in the system to solve is parametrized as follows: </p><div class="eqnarray">\begin{eqnarray} c_{xx} \partial _{xx} \psi + c_{xy} \partial _{xy} \psi + c_{xz} \partial _{xz} \psi + c_{yy} \partial _{yy} \psi + c_{yz} \partial _{yz} \psi + c_{zz} \partial _{zz} \psi &amp;+&amp; \\ c_{x} \partial _{x} \psi + c_{y} \partial _{y} \psi + c_{z} \partial _{z} \psi + c_{0} \psi ^{n_0} + c_{1} \psi ^{n_1} + c_{2} \psi ^{n_2} + c_{3} \psi ^{n_3} + c_4 \psi ^{n_4} &amp;=&amp; 0 \end{eqnarray}
</div>All the coefficients \(c_*\) and the powers \(n_*\) can be specified by setting the parameters <span 
class="cmtt-10">*</span><span 
class="cmtt-10">_gfname[*] </span>to the
desired grid function name. These parameters are arrays to allow for the solution of systems of
equations.
<!--l. 189--><p class="noindent" >The only other parameter which must be set to ensure correct operation is <span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel::topMGlevel</span>, which
tells the solver which is the finest refinement level that covers the entire domain in which the equation is to be
solved. All levels below and including this will be used in the classical multigrid sense (e.g., in a V- or
FMG-cycle). The ones above will be treated as local AMR boxes, and be solved via a multilevel prescription;
presently, this involves simply interpolating the solution from the <span 
class="cmtt-10">topMGlevel </span>refinement level at
the end of the multigrid part and relaxing it progressively, from coarser to finer, on all the local
grids.
</p><!--l. 201--><p class="noindent" >Other parameters control the stopping criteria (numbers of relaxation sweeps and residual tolerance), the
finite-differencing order used to discretized the equation, the number of equations in the system, and
whether the solution error should be calculated (this obviously requires the exact solution to be
known and stored in a grid function, its name passed to <span 
class="cmtt-10">CT</span><span 
class="cmtt-10">_MultiLevel </span>via the usual parameter
mechanism).
</p><!--l. 209--><p class="noindent" >Concrete examples on how to set these parameters are provided below.
                                                                                       


